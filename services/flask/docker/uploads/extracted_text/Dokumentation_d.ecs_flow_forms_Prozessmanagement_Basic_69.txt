d.vetop

academy
Tutorial d.ecs forms basis

11.4.1. Server-Seitig

Ein Beispiel fur die Mdglichkeit, eine Formular-Instance-ID serverseitig zu erzeugen, kann der

d.ecs forms server-Dokumentation entnommen werden.

 

11.4.2. Im Workflow mittels JPL

Die Formular-Instance-ID kann Uber in einem Action-Skript innerhalb des Workflows mittels JPL
erzeugt und Uber die im Weiteren erklarten Mechanismen in die Formular-Instance-ID tbernommen
werden.

AC mS SUG E  )sfSTT RcA  ad

vars 1UUID 0
vars formInstancelId ~

// The formInstanceId will be set when the request was started via intranet or
// process protal

vars formInstanceId = dok_dat_feld[30]

// STEP 2: Set the formInstanceId if not set already
if( formInstanceId == "" )
{
1UUID = sm_sdtime( "n%0d%0m%4y-%0h%0M%0s" ) // get a current timestamp -----

// STEP 3: Generate a unique process-id
formInstanceId = "UA-" ## doku_id ## "-" ## lUUID

 

}

// STEP 4: Make them global for the complete workflow -------------------------
call save_vars( "formInstanceId" )

Uber diese Methode steht damit eine eindeutige Formular-Instance-ID fiir den ersten Schritt im
Workflow zur Verfiigung. Es sind keine zusatzlichen Arbeiten innerhalb des Formulars notwendig.
Dies gilt nur fur Workflows, welche ,,NICHT” im Quickstart-Mode gestartet werden!

11.4.3. Im Formular bei Initialisierung

Wird ein Formular Uber einen Workflow im Quickstart-Mode oder Uber einen Link im Intranet
gestartet, muss das Formular die Formular-Instance-ID spatestens vor dem Ersten Abspeichern
setzen. Empfehlung ist, fur den Bereich der Initialisierung die Funktion

form.misc.formParams.setInstancelId( "<instanceId>" );

zu nutzen.

Hier kann zum Beispiel auch Uber einen vergleichbaren Mechanismus, wie in dem JPL-Beispiel, eine
eindeutige ID erzeugt werden.

// STEP 1: Erzeugung einer Instance-ID auf Basis des aktuellen Datums

var tmpDate = new Date();

var currentID = "";

var tmpDay, tmpMonth;

tmpDay = ( tmpDate.getDate() < 10 ) ? ("O"+tmpDate.getDate()) : tmpDate.getDate();

tmpMonth = ((tmpDate.getMonth()+1) < 10 ) ? ("0"4+(tmpDate.getMonth()+1)) : (tmpDate.getMonth()+1);
currentID = tmpDay + "-" + tmpMonth + "-" + tmpDate.getFullYear() + "-" + tmpDate.getUTCSeconds ();

form.misc.formParams.setInstanceId( "wfl/" +
form.misc.formParams.request.getValue("docId") +
"/" + currentID );

Thema - Vermischtes

70/81 d.velop